<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
  <script type=text/javascript src="./js/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="./css/style.css" />
  <title>The Witcher Trivia Map of Europe</title>
  <style type="text/css">
    html, body { height: 100%; margin: 0; padding: 0; }
    #map { height: 100%; }
  </style>
</head>

<body>
  <header>
    <nav class="navbar navbar-default">
      <div class="container-fluid">
      </div>
    </nav>
  </header>
  <div class='container'>
    <div class='row'>
      <div class='col-md-4'>
        <ul id="locations-list" data-bind='foreach: locationsList, visible: showLocations'>
          <li>
            <input type='checkbox' data-bind='click: $parent.toggleMarker, checked: active'>
            <button data-bind="text: title, click: $parent.selectLocation, style: { backgroundColor: active()  ? 'red' : 'gray' }"></button>
          </li>
        </ul>
      </div>
      <div class='col-md-4'>
        <ul id="characters-list" data-bind='foreach: charactersList, visible: showCharacters'>
          <li>
            <input type='checkbox' data-bind='click: $parent.toggleMarker, checked: active'>
            <button data-bind="text: title, click: $parent.selectLocation, style: { backgroundColor: active() ? 'red' : 'gray' }"></button>
          </li>
        </ul>
        <div data-bind='with: currentMarker'>
          <p data-bind='text: title'></p>
        </div>
      </div>
      <div class='col-md-4'>
        <form>
          <p>Show Locations</p>
          <input type='checkbox' data-bind='checked: showLocations'>
          <p>Show Characters</p>
          <input type='checkbox' data-bind='checked: showCharacters'>
        </form>
        <p>Filter: <input data-bind="value: filter, valueUpdate: 'afterkeydown'" /></p>

      </div>
    </div>
  </div>

  <div id="map">
  </div>
    <script>
      var map;

      var mapMarkers = [];

      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 54.675605, lng: -4.4455836},
          zoom: 4
      });

      var largeInfoWindow = new google.maps.InfoWindow();
      var bounds = new google.maps.LatLngBounds();

      for (var i = 0; i<markers.length; i++){
        var position = markers[i].location;
        var title = markers[i].title;

        var marker = new google.maps.Marker({
          map: map,
          position: position,
          title: title,
          animation: google.maps.Animation.DROP,
          id: i
        });
        mapMarkers.push(marker);
        bounds.extend(marker.position);
        marker.addListener('click', function(){
          populateInfoWindow(this, largeInfoWindow)
        });
      }
      map.fitBounds(bounds);

      function populateInfoWindow(marker, infowindow){
        if(infowindow.marker != marker){
          infowindow.marker = marker;
          html = '<div>' + marker.title + '</div>'
          infowindow.setContent(html);
          infowindow.open(map, marker);
          infowindow.addListener('closeclick', function(){
            infowindow.setMarker = null;
          });
        }
      }
    }
    </script>



  <footer>
  </footer>
  <script src="js/lib/knockout-3.2.0.js"></script>
  <script src="js/app.js"></script>
  <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCQ_EKUiWMO35cymsNlEly0DmtAk8tiqps&v=3&callback=initMap">
  </script>

</body>
</html>
