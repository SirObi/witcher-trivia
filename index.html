<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
  <script type=text/javascript src="./js/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="./css/style.css" />
  <title>The Witcher Trivia Map of Europe</title>
  <style type="text/css">
    html, body { height: 100%; margin: 0; padding: 0; }
    #map { height: 100%; }
  </style>
</head>

<body>
  <header>
    <nav class="navbar navbar-default">
      <div class="container-fluid">
      </div>
    </nav>
  </header>
  <div class='container'>
    <div class='row'>
      <div class='col-md-4'>
        <ul id="locations-list" data-bind='foreach: locationsList, visible: showLocations'>
          <li><button data-bind='text: title, click: $parent.selectLocation'></button></li>
        </ul>
      </div>
      <div class='col-md-4'>
        <ul id="characters-list" data-bind='foreach: charactersList, visible: showCharacters'>
          <li><button data-bind='text: title, click: $parent.selectLocation'></button></li>
        </ul>
      </div>
      <div class='col-md-4'>
        <form>
          <p>Show Locations</p>
          <input type='checkbox' data-bind='checked: showLocations'>
          <p>Show Characters</p>
          <input type='checkbox' data-bind='checked: showCharacters'>
        </form>
        <p>Filter: <input data-bind="value: filter, valueUpdate: 'afterkeydown'" /></p>
      </div>
    </div>
  </div>

  <div id="map">
  </div>

    <script>
      var map;

      var markers = [];

      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 54.675605, lng: -4.4455836},
          zoom: 4
      });

      var locations = [
        {title: "Birka", location: {lat: 59.3352163, lng: 17.5425896}},
        {title: "Yennefer", location: {lat: 51.6121678, lng: -3.0224666}},
        {title: "Francesca Findabair", location: {lat: 53.6256191, lng: -8.2031646}},
        {title: "Bronibor", location: {lat: 52.4268039, lng: 12.4034553}},
        {title: "Dijkstra", location: {lat: 51.9280573, lng: 4.4203664}},
        {title: "Esterad Thyssen", location: {lat: 51.4111465, lng: 6.8130815}},
        {title: "Cintra", location: {lat: 38.8356907, lng: -9.5007252}},
        {title: "..., elle'a?", location: {lat: 64.7555353, lng: 16.9006833}},
        {title: "Maribor", location: {lat: 46.5536366, lng: 15.5745097}},
      ];

      var largeInfoWindow = new google.maps.InfoWindow();
      var bounds = new google.maps.LatLngBounds();

      for (var i = 0; i<locations.length; i++){
        var position = locations[i].location;
        var title = locations[i].title;

        var marker = new google.maps.Marker({
          map: map,
          position: position,
          title: title,
          animation: google.maps.Animation.DROP,
          id: i
        });
        markers.push(marker);
        bounds.extend(marker.position);
        marker.addListener('click', function(){
          populateInfoWindow(this, largeInfoWindow)
        });
      }
      map.fitBounds(bounds);

      function populateInfoWindow(marker, infowindow){
        if(infowindow.marker != marker){
          infowindow.marker = marker;
          infowindow.setContent('<div>' + marker.title + '</div>');
          infowindow.open(map, marker);
          infowindow.addListener('closeclick', function(){
            infowindow.setMarker = null;
          });
        }
      }
    }
    </script>



  <footer>
  </footer>
  <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCQ_EKUiWMO35cymsNlEly0DmtAk8tiqps&v=3&callback=initMap">
  </script>
  <script src="js/lib/knockout-3.2.0.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
